<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>一、关于Set</title>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
        
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        
        
    </head>
    <body class="vscode-light">
        <!-- Set -->
<h1 id="%e4%b8%80%e5%85%b3%e4%ba%8eset">一、关于Set</h1>
<h3 id="1set-%e7%9a%84%e5%ae%9a%e4%b9%89">1、Set 的定义</h3>
<ul>
<li>对象可以存储任意类型的值，Set 中的元素是唯一的。</li>
</ul>
<h3 id="2set-%e5%af%b9%e8%b1%a1%e5%86%85%e9%83%a8%e9%87%87%e7%94%a8-samevaluezero-sup1sup-%e7%ae%97%e6%b3%95%e5%af%b9%e5%85%83%e7%b4%a0%e8%bf%9b%e8%a1%8c%e6%af%94%e8%be%83%e5%8e%bb%e9%87%8d">2、Set 对象内部采用 SameValueZero <sup><a href="#a">[1]</a></sup> 算法对元素进行比较去重</h3>
<!-- [^1]:SameValueZero：+0 与 -0 不相等；NaN 与 NaN 相等；其余同 ===; [🔗](https://www.ecma-international.org/ecma-262/6.0/#sec-samevaluezero) -->
<h3 id="3set-%e5%b1%9e%e6%80%a7">3、Set 属性</h3>
<ul>
<li>Set.prototype：Set 构造器的原型。</li>
<li>Set.length：Set 对象的长度。</li>
<li>Set[@@species]：构造函数用来创建派生对象。</li>
</ul>
<h3 id="4set-%e5%ae%9e%e4%be%8b%e9%80%9a%e8%bf%87-new-setiterable-%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa-set-%e5%af%b9%e8%b1%a1">4、Set 实例：通过 new Set([iterable]) 创建一个 Set 对象</h3>
<ul>
<li>如果传入一个可迭代对象，所有元素将无重复的传入 Set 中，如果传入 null 或者不传参数，新的 Set 默认为空。</li>
</ul>
<h3 id="5set-%e5%ae%9e%e4%be%8b%e7%9a%84%e5%b1%9e%e6%80%a7">5、Set 实例的属性</h3>
<ul>
<li>Set.prototype.constructor：实例的构造函数，默认指向 Set。</li>
<li>Set.prototype.size：返回 Set 对象的值的个数。</li>
</ul>
<h3 id="6set-%e5%ae%9e%e4%be%8b%e7%9a%84%e6%96%b9%e6%b3%95">6、Set 实例的方法</h3>
<blockquote>
<p>四种操作方法</p>
</blockquote>
<ol>
<li>
<p>Set.prototype.add(value)：往 Set 对象尾部添加元素，返回 Set 对象。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> set1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>();

set1.add(<span class="hljs-number">1</span>).add(<span class="hljs-string">'a'</span>).add([<span class="hljs-number">2</span>]);

<span class="hljs-built_in">console</span>.log(set1);   <span class="hljs-comment">// Set { 1, 'a', [ 2 ] }</span>
</div></code></pre>
</li>
<li>
<p>Set.prototype.delete(value)：移除指定的元素，Set 对象中能找到该元素，返回 true， 否则返回 false。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> set1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-string">'1'</span>, <span class="hljs-string">'a'</span>, [<span class="hljs-number">2</span>]]);

set1.delete(<span class="hljs-number">1</span>);  <span class="hljs-comment">// false</span>

<span class="hljs-built_in">console</span>.log(set1); <span class="hljs-comment">// Set { '1', 'a', [ 2 ] }</span>

set1.delete(<span class="hljs-string">'1'</span>);   <span class="hljs-comment">// true</span>

<span class="hljs-built_in">console</span>.log(set1);  <span class="hljs-comment">// Set { 'a', [ 2 ] }</span>
</div></code></pre>
</li>
<li>
<p>Set.prototype.has(value)：判断值是否存在于 Set 对象中，返回布尔值。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> set1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-string">'1'</span>, <span class="hljs-string">'a'</span>, [<span class="hljs-number">2</span>]]);

<span class="hljs-built_in">console</span>.log(set1.has(<span class="hljs-string">'a'</span>)); <span class="hljs-comment">// true</span>
</div></code></pre>
</li>
<li>
<p>Set.prototype.clear()： 移除 Set 对象内的所有元素。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> set1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-string">'1'</span>, <span class="hljs-string">'a'</span>, [<span class="hljs-number">2</span>]]);

set1.clear();

<span class="hljs-built_in">console</span>.log(set1);  <span class="hljs-comment">// Set {}</span>
</div></code></pre>
</li>
</ol>
<blockquote>
<p>四种遍历方法</p>
</blockquote>
<ol>
<li>
<p>Set.prototype.keys()：返回一个新的迭代器对象，该对象包 Set 对象中按插入顺序排列的所有元素的值。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> set1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-string">'a'</span>, [<span class="hljs-number">2</span>], {<span class="hljs-attr">x</span>: <span class="hljs-number">3</span>}]);

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">of</span> set1.keys()) {
    <span class="hljs-built_in">console</span>.log(item);  <span class="hljs-comment">// 1, 'a', [2], {x: 3}</span>
}
</div></code></pre>
</li>
<li>
<p>Set.prototype.values()：同 keys() 方法。</p>
</li>
<li>
<p>Set.prototype.entries(): 返回一个新的迭代器对象，该对象包含 Set 对象中按插入顺序排列的所有元素的值的 [value, value] 数组。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> set1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-string">'a'</span>, [<span class="hljs-number">2</span>], {<span class="hljs-attr">x</span>: <span class="hljs-number">3</span>}]);

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">of</span> set1.entries()) {
    <span class="hljs-built_in">console</span>.log(item);  <span class="hljs-comment">// [1, 1], ['a', 'a'], [[2], [2]], [{x: 3}, {x: 3}]</span>
}
</div></code></pre>
</li>
<li>
<p>Set.prototype.forEach(callbackFn[, thisArg])：为 Set 对象中的每个值执行一次 callbackFn()，如果指定了 thisArg，回调中的 this 会是这个值。</p>
</li>
</ol>
<ul>
<li>
<p>不能通过 forEach 循环遍历修改 Set 对象。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> set1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]);

set1.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
    <span class="hljs-built_in">console</span>.log(value + <span class="hljs-string">'-'</span> + key); <span class="hljs-comment">// 1-1, 2-2</span>
}
</div></code></pre>
</li>
</ul>
<h3 id="7set-%e5%ba%94%e7%94%a8%e5%ae%9e%e6%88%98">7、Set 应用实战</h3>
<ol>
<li>
<p>Set 转换数组</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> set1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'a'</span>]);

<span class="hljs-keyword">let</span> arr = [...set1];

<span class="hljs-keyword">let</span> arr = <span class="hljs-built_in">Array</span>.from(set1);

<span class="hljs-built_in">console</span>.log(arr); <span class="hljs-comment">// [1, 2, 'a']</span>
</div></code></pre>
</li>
<li>
<p>数组去重(unique)</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-keyword">let</span> unique = [...new <span class="hljs-built_in">Set</span>(arr)];

<span class="hljs-built_in">console</span>.log(unique); <span class="hljs-comment">// [1, 2, 3, 4, 5]</span>
</div></code></pre>
</li>
<li>
<p>实现并集(union)、交集(intersect)、差集(difference)</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> set1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);

<span class="hljs-keyword">let</span> set2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>]);

<span class="hljs-keyword">let</span> union = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...set1, ...set2]);
<span class="hljs-built_in">console</span>.log(union); <span class="hljs-comment">// Set {1, 2, 3, 4, 5, 6, 7, 8}</span>

<span class="hljs-keyword">let</span> intersect = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...set1].filter(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> set2.has(x)));
<span class="hljs-built_in">console</span>.log(intersect); <span class="hljs-comment">// Set {3, 5}</span>

<span class="hljs-keyword">let</span> difference = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...set1].filter(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> !set2.has(x)));
<span class="hljs-built_in">console</span>.log(difference); <span class="hljs-comment">// Set {1, 2, 4}</span>
</div></code></pre>
</li>
<li>
<p>变更 Set 结构：将 Set 变更为数组，对数组进行操作后再转换为 Set 结构</p>
</li>
</ol>
<ul>
<li>
<p>例：实现 Set 中的值+1</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> set1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);

<span class="hljs-keyword">let</span> res = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...set1].map(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> ++x));

<span class="hljs-keyword">let</span> res = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(<span class="hljs-built_in">Array</span>.from(set1, x =&gt; ++x));

<span class="hljs-built_in">console</span>.log(res); <span class="hljs-comment">// Set {2, 3, 4, 5, 6}</span>
</div></code></pre>
</li>
</ul>
<p> </p>
<!-- WeakSet -->
<h1 id="%e4%ba%8cweakset">二、WeakSet</h1>
<h3 id="1weakset-%e5%ae%9a%e4%b9%89">1、WeakSet 定义</h3>
<ul>
<li>WeakSet 对象是一些对象的值的集合，每个对象只能出现一次。</li>
</ul>
<h3 id="2weakset-%e4%b8%8e-set-%e7%9a%84%e5%8c%ba%e5%88%ab">2、WeakSet 与 Set 的区别</h3>
<ul>
<li>WeakSet 只能存放对象引用，不能存放值，即成员只能是对象。</li>
<li>WeakSet 中的值都是弱引用，如果没有其他的对象或者属性引用这个值，它会被垃圾回收机制回收掉。因此，Weakset 无法被枚举。</li>
</ul>
<h3 id="3weakset-%e5%b1%9e%e6%80%a7">3、WeakSet 属性</h3>
<ul>
<li>WeakSet.prototype： WeakSet 对象的原型</li>
<li>WeakSet.length： WeakSet 对象的长度</li>
<li>WeakSet.prototype [ @@toStringTag ]：{ [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: true }</li>
</ul>
<h3 id="4weakset-%e5%ae%9e%e4%be%8b%e9%80%9a%e8%bf%87-new-weaksetiterable-%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa-weakset-%e5%af%b9%e8%b1%a1">4、WeakSet 实例：通过 new WeakSet([iterable]) 创建一个 WeakSet 对象</h3>
<ul>
<li>如果传入一个可迭代对象，所有元素将无重复的传入 WeakSet 中，如果传入 null 或者不传参数，新的 WeakSet 默认为空。</li>
</ul>
<h3 id="5weakset-%e5%ae%9e%e4%be%8b%e7%9a%84%e5%b1%9e%e6%80%a7">5、WeakSet 实例的属性</h3>
<ul>
<li>WeakSet.prototype.constructor</li>
</ul>
<h3 id="6weakset-%e5%ae%9e%e4%be%8b%e7%9a%84%e6%96%b9%e6%b3%95">6、WeakSet 实例的方法</h3>
<ol>
<li>
<p>WeakSet.has(value)：在该 WeakSet 对象中添加一个新元素 value</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> weakset = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakSet</span>();

weakset.add(<span class="hljs-built_in">window</span>);

<span class="hljs-built_in">console</span>.log(weakset); <span class="hljs-comment">// WeakSet { window 对象 }</span>
</div></code></pre>
</li>
<li>
<p>WeakSet.delete(value)：删除 WeakSet 对象中的 value 值</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> weakset = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakSet</span>([<span class="hljs-built_in">document</span>.body, <span class="hljs-built_in">window</span>]);

weakset.delete(<span class="hljs-built_in">document</span>.body);

<span class="hljs-built_in">console</span>.log(weakset); <span class="hljs-comment">// WeakSet { window 对象 }</span>
</div></code></pre>
</li>
<li>
<p>WeakSet.has(value)：判断 value 是否存在于 WeakSet 对象中</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> weakset = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakSet</span>([<span class="hljs-built_in">window</span>]);

<span class="hljs-built_in">console</span>.log(weakset.has(<span class="hljs-built_in">window</span>)); <span class="hljs-comment">// true</span>

weakset.delete(<span class="hljs-built_in">window</span>);

<span class="hljs-built_in">console</span>.log(weakset.has(<span class="hljs-built_in">window</span>)); <span class="hljs-comment">// false</span>
</div></code></pre>
</li>
</ol>
<h3 id="7weakset-%e5%ba%94%e7%94%a8">7、WeakSet 应用</h3>
<ul>
<li>存储 DOM 节点，避免内存泄漏。</li>
</ul>
<p> </p>
<!-- Map -->
<h1 id="%e4%b8%89map">三、Map</h1>
<h3 id="1map-%e7%9a%84%e5%ae%9a%e4%b9%89">1、Map 的定义</h3>
<ul>
<li>
<p>Map 对象保存键值对，任意值（对象或者原始值）都可以作为键或者值。</p>
</li>
<li>
<p>Map 中的键值是唯一的。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();

map.set(<span class="hljs-string">'x'</span>, <span class="hljs-number">1</span>);
<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map { 'x' =&gt; 1 }</span>

map.set(<span class="hljs-string">'x'</span>, <span class="hljs-number">2</span>);
<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map { 'x' =&gt; 2 }</span>
</div></code></pre>
</li>
</ul>
<h3 id="2map-%e7%9a%84%e8%af%ad%e6%b3%95">2、Map 的语法</h3>
<ul>
<li>new Map([iterable])：iterable 可以是一个数组或者其他 iterable 对象，其元素为键值对(['a', 1], ['b', 2])。</li>
<li>null 会被当作 undefined 来处理。</li>
<li>Map 内部键的比较基于 SameValueZero <sup><a href="#a">a</a></sup>。</li>
</ul>
<h3 id="3map-%e4%b8%8e-object-%e7%9a%84%e5%af%b9%e6%af%94">3、Map 与 Object 的对比</h3>
<ul>
<li>Object 的键只能是字符串或者 Symbols，Map 的键可以是任意值。</li>
<li>Map 中的键是有序的，按照插入顺序遍历。</li>
<li>Map.prototype.size 可以直接获取 Map 对象的键值对的个数。</li>
<li>Map 可以直接进行迭代，Object 需要先获取键数组才能迭代。</li>
<li>Map 在处理频繁增删键值对的场景下具有一定的性能优势。</li>
</ul>
<h3 id="4map-%e7%9a%84%e5%b1%9e%e6%80%a7">4、Map 的属性</h3>
<ul>
<li>Map.length: 0</li>
<li>Map.prototype</li>
<li>get Map[@@species]：创建派生对象</li>
</ul>
<h3 id="5map-%e5%ae%9e%e4%be%8b%e7%9a%84%e5%b1%9e%e6%80%a7">5、Map 实例的属性</h3>
<ul>
<li>
<p>Map.prototype.constructor</p>
</li>
<li>
<p>Map.prototype.size: 返回 Map 键值对的数量</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>]]);

<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map { 'a' =&gt; 1, 2 =&gt; undefined }</span>

<span class="hljs-built_in">console</span>.log(map.size); <span class="hljs-comment">// 2</span>
</div></code></pre>
</li>
</ul>
<h3 id="6map-%e5%ae%9e%e4%be%8b%e7%9a%84%e6%96%b9%e6%b3%95">6、Map 实例的方法</h3>
<blockquote>
<p>5个操作方法</p>
</blockquote>
<ol>
<li>
<p>Map.prototype.set(key, value)</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map {}</span>

map.set();
<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map { undefined =&gt; undefined }</span>

map.set(<span class="hljs-literal">null</span>);
<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map { undefined =&gt; undefined, null =&gt; undefined }</span>

map.set(<span class="hljs-literal">undefined</span>, <span class="hljs-number">1</span>);
<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map { undefined =&gt; 1, null =&gt; undefined }</span>
</div></code></pre>
</li>
<li>
<p>Map.prototype.get(key)</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();

<span class="hljs-built_in">console</span>.log(map.get(<span class="hljs-string">'a'</span>)); <span class="hljs-comment">// undefined</span>
<span class="hljs-built_in">console</span>.log(map.get()); <span class="hljs-comment">// undefined</span>

map.set(<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>);
<span class="hljs-built_in">console</span>.log(map.get(<span class="hljs-string">'a'</span>)); <span class="hljs-comment">// 1</span>
</div></code></pre>
</li>
<li>
<p>Map.prototype.has(key)</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();

<span class="hljs-built_in">console</span>.log(map.has(<span class="hljs-string">'a'</span>)); <span class="hljs-comment">// false</span>
<span class="hljs-built_in">console</span>.log(map.has()); <span class="hljs-comment">// false</span>

map.set(<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>);
<span class="hljs-built_in">console</span>.log(map.has(<span class="hljs-string">'a'</span>)); <span class="hljs-comment">// true</span>
</div></code></pre>
</li>
<li>
<p>Map.prototype.delete(key)</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();

<span class="hljs-built_in">console</span>.log(map.delete(<span class="hljs-string">'a'</span>)); <span class="hljs-comment">// false</span>
<span class="hljs-built_in">console</span>.log(map.delete()); <span class="hljs-comment">// false</span>

map.set(<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>);
<span class="hljs-built_in">console</span>.log(map.delete(<span class="hljs-string">'a'</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map {}</span>
</div></code></pre>
</li>
<li>
<p>Map.prototype.clear()</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();

map.set(<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>);
<span class="hljs-built_in">console</span>.log(map.clear()); <span class="hljs-comment">// undefined</span>
<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map {}</span>
</div></code></pre>
</li>
</ol>
<blockquote>
<p>4个遍历方法</p>
</blockquote>
<ol>
<li>
<p>Map.prototype.keys()：返回 Interable 对象，按照插入顺序包含了每个元素的键。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>]]);

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">of</span> map.keys()) {
    <span class="hljs-built_in">console</span>.log(key); <span class="hljs-comment">// a, b</span>
}
</div></code></pre>
</li>
<li>
<p>Map.prototype.values()：返回 Iterable 对象，按照插入顺序包含了每个元素的值。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>]]);

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> value <span class="hljs-keyword">of</span> map.values()) {
    <span class="hljs-built_in">console</span>.log(value); <span class="hljs-comment">// 1, 2</span>
}
</div></code></pre>
</li>
<li>
<p>Map.prototype.entries()：返回 Iterable 对象，按照插入顺序包含了每个元素的 [key, value] 数组。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>]]);

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">of</span> map.entries()) {
    <span class="hljs-built_in">console</span>.log(item); <span class="hljs-comment">// ['a', 1], ['b', 2]</span>
}

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> [key, value] <span class="hljs-keyword">of</span> map.entries()) {
    <span class="hljs-built_in">console</span>.log(key + <span class="hljs-string">' - '</span> + value); <span class="hljs-comment">// a - 1, b - 2</span>
}
</div></code></pre>
</li>
<li>
<p>Map.prototype.forEach(callbackFn[, thisArg])：按照插入顺序为每个元素的键值对执行一次 callbackFn 函数，如果指定了 thisArg，回调函数的 this 会是这个值。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], <span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>]);

map.forEach(<span class="hljs-function">(<span class="hljs-params">value, key</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(key + <span class="hljs-string">' - '</span> + value); <span class="hljs-comment">// a - 1, b - 2</span>
})
</div></code></pre>
</li>
</ol>
<h3 id="7map-%e4%b8%8e%e5%85%b6%e4%bb%96%e7%b1%bb%e5%9e%8b%e7%9a%84%e8%bd%ac%e6%8d%a2">7、Map 与其他类型的转换</h3>
<ol>
<li>
<p>Map 转数组</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>]]);

<span class="hljs-keyword">let</span> arr = [...map];
<span class="hljs-built_in">console</span>.log(arr); <span class="hljs-comment">// [['a', 1], ['b', 2]]</span>
</div></code></pre>
</li>
<li>
<p>数组转Map</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> arr = [[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>]];

<span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>(arr);
<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map { 'a' =&gt; 1, 'b' =&gt; 2 }</span>
</div></code></pre>
</li>
<li>
<p>Map 转对象</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>]]);

<span class="hljs-keyword">const</span> mapToObj = <span class="hljs-function"><span class="hljs-params">map</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> obj = {};
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> [key, value] <span class="hljs-keyword">of</span> map) {
        obj[key] = value;
    }
    <span class="hljs-keyword">return</span> obj;
}

<span class="hljs-keyword">let</span> obj = mapToObj(map);
<span class="hljs-built_in">console</span>.log(obj); <span class="hljs-comment">// { a: 1, b: 2 }</span>
</div></code></pre>
</li>
<li>
<p>对象转 Map</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> obj = {
    <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>
}

<span class="hljs-keyword">const</span> objToMap = <span class="hljs-function"><span class="hljs-params">obj</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">in</span> obj) {
        map.set(item, obj[item]);
    }
    <span class="hljs-keyword">return</span> map;
}

<span class="hljs-keyword">let</span> map = objToMap(obj);
<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map { 'a' =&gt; 1, 'b' =&gt; 2 }</span>
</div></code></pre>
</li>
<li>
<p>Map 转 JSON</p>
<ul>
<li>
<p>Map 转换 JSON 字符串</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>]]);

<span class="hljs-keyword">let</span> json = <span class="hljs-built_in">JSON</span>.stringify(mapToObj(map));

<span class="hljs-built_in">console</span>.log(json); <span class="hljs-comment">// '{"a": 1, "b": 2}'</span>
</div></code></pre>
</li>
<li>
<p>Map 转换 JSON 数组</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[<span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>], [{<span class="hljs-attr">x</span>:<span class="hljs-number">3</span>}, <span class="hljs-number">2</span>]]);

<span class="hljs-keyword">let</span> json = <span class="hljs-built_in">JSON</span>.stringify([...map]);

<span class="hljs-built_in">console</span>.log(json); <span class="hljs-comment">// '[["a", 1], [{"x":3}, 2]]'</span>
</div></code></pre>
</li>
</ul>
</li>
<li>
<p>JSON 转 Map</p>
<ul>
<li>
<p>JSON 字符串转 Map</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> json = <span class="hljs-string">'{"a": 1, "b": 2}'</span>;

<span class="hljs-keyword">let</span> map = objToMap(<span class="hljs-built_in">JSON</span>.parse(json));

<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map { 'a' =&gt; 1, 'b' =&gt; 2 }</span>
</div></code></pre>
</li>
<li>
<p>JSON 数组转 Map</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> json = <span class="hljs-string">'[["a", 1], [{"x":3}, 2]]'</span>;

<span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>(<span class="hljs-built_in">JSON</span>.parse(json));

<span class="hljs-built_in">console</span>.log(map); <span class="hljs-comment">// Map { 'a' =&gt; 1, { x: 3 } =&gt; 2 }</span>
</div></code></pre>
</li>
</ul>
</li>
</ol>
<p> </p>
<!-- WeakMap -->
<h1 id="4weakmap">4、WeakMap</h1>
<h3 id="1weakmap-%e7%9a%84%e5%ae%9a%e4%b9%89">1、WeakMap 的定义</h3>
<ul>
<li>WeakMap 是键值对的集合，它的键是弱引用的。</li>
<li>WeakMap 的键只能是对象。</li>
<li>WeakMap 不能被遍历。</li>
</ul>
<h3 id="2weakmap-%e7%9a%84%e8%af%ad%e6%b3%95">2、WeakMap 的语法</h3>
<ul>
<li>new WeakMap([Iterable])：Iterable 是一个数组（二元数组）或者其他可迭代的且其元素是键值对的对象。每个键值对会被加到新的 WeakMap 里。null 会被当做 undefined。</li>
</ul>
<h3 id="3weakmap-%e7%9a%84%e5%b1%9e%e6%80%a7">3、WeakMap 的属性</h3>
<ul>
<li>WeakMap.length: 0</li>
<li>WeakMap.prototype</li>
</ul>
<h3 id="4weakmap-%e7%9a%84%e5%ae%9e%e4%be%8b%e5%b1%9e%e6%80%a7">4、WeakMap 的实例属性</h3>
<ul>
<li>WeakMap.prototype.constructor</li>
</ul>
<h3 id="5weakmap-%e7%9a%84%e5%ae%9e%e4%be%8b%e6%96%b9%e6%b3%95">5、WeakMap 的实例方法</h3>
<ul>
<li>
<p>WeakMap.prototype.add(key, value)</p>
</li>
<li>
<p>WeakMap.prototype.has(key)</p>
</li>
<li>
<p>WeakMap.prototype.get(key)</p>
</li>
<li>
<p>WeakMap.prototype.delete(key)</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> weakmap = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>();

<span class="hljs-keyword">let</span> key = {
    <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>
}

<span class="hljs-keyword">let</span> key2 = {
    <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>
}

<span class="hljs-keyword">let</span> key3 = key;

weakmap.set(key, <span class="hljs-number">2</span>);

<span class="hljs-built_in">console</span>.log(weakmap.get(key), weakmap.get(key2), weakmap.get(key3)); <span class="hljs-comment">// 2 undefined 2</span>

<span class="hljs-built_in">console</span>.log(weakmap.has(key), weakmap.has(key2), weakmap.has(key3)); <span class="hljs-comment">// true false true</span>

<span class="hljs-built_in">console</span>.log(weakmap.delete(key), weakmap.delete(key2), weakmap.delete(key3)); <span class="hljs-comment">// true false false</span>
</div></code></pre>
</li>
</ul>
<h3 id="6weakmap-%e7%9a%84%e5%ba%94%e7%94%a8">6、WeakMap 的应用</h3>
<ol>
<li>
<p>存储一个对象的私有数据或隐藏实施细节。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">const</span> privites = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Public</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> me = {
        <span class="hljs-comment">// some privite data here</span>
    };
    privites.set(<span class="hljs-keyword">this</span>, me);
}

Public.prototype.method = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> me = privites.get(<span class="hljs-keyword">this</span>);
    <span class="hljs-comment">// do some thing with privites data</span>
}

<span class="hljs-built_in">module</span>.exports = Public;
</div></code></pre>
</li>
<li>
<p>存储 DOM 节点作为键值，可以不用考虑内存泄漏的风险。</p>
<pre><code class="language-javascript"><div><span class="hljs-keyword">let</span> el = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'li'</span>);

<span class="hljs-keyword">let</span> weakmap = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>();

weakmap.set(el, [clicked: <span class="hljs-number">0</span>]);

el.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> times = weakmap.get(el);
    times.clicked++;
}, <span class="hljs-literal">false</span>)
</div></code></pre>
</li>
</ol>
<p> </p>
<blockquote>
<p><strong>备注区域</strong></p>
<ol>
<li><span id="a">SameValueZero：+0 与 -0 相等；NaN 与 NaN 相等；其余同 ===; <a href="https://www.ecma-international.org/ecma-262/6.0/#sec-samevaluezero">🔗</a></span></li>
</ol>
</blockquote>
<p> </p>
<blockquote>
<p><strong>参考文献</strong></p>
<ol>
<li><a href="https://www.ecma-international.org/ecma-262/6.0/#sec-set-objects">ECMAScript 2015 (6th Edition, ECMA-262)</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Set">MDN 标准内置对象Set</a></li>
<li><a href="http://es6.ruanyifeng.com/#docs/set-map#Set">阮一峰 ECMAScript 6入门 Set 和 Map 数据结构</a></li>
</ol>
</blockquote>

    </body>
    </html>